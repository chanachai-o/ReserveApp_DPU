<!-- Bill Summary Modern Card -->
<div class="bill-summary-card">
  <!-- Customer / Table / Amount -->
  <div class="bill-section">
    <div class="bill-row">
      <span>ลูกค้า</span>
      <span class="bill-strong bill-color">{{ reservation.customer.name || reservation.customer.phone || '-' }}</span>
    </div>
    <div class="bill-row">
      <span>โต๊ะ/ห้อง</span>
      <span>
        <ng-container *ngIf="reservation.table">โต๊ะ {{ reservation.table.table_number }}</ng-container>
        <ng-container *ngIf="reservation.room">ห้อง {{ reservation.room.room_name }}</ng-container>
      </span>
    </div>
    <div class="bill-row bill-total">
      <span>ยอดรวม</span>
      <span class="bill-total-amount">{{ getTotalAmount() | number:'1.2-2' }} ฿</span>
    </div>
  </div>

  <!-- Order Items -->
  <div class="bill-list-section">
    <h4><i class="ri-restaurant-line"></i> รายการอาหาร</h4>
    <ul>
      <li *ngFor="let item of getAllOrderItems()">
        <div class="item-info">
          <img [src]="item.menu.image_url ? item.menu.getPicture() : './assets/images/faces/111.jpg'" />
          <span>
            {{ item.menu.name }} <span *ngIf="item.quantity > 1" class="qty-info">x{{ item.quantity }} ({{
              item.menu.price | number:'1.2-2' }} ฿)</span>
          </span>
        </div>
        <span class="item-amount">
          {{ item.menu.price * item.quantity | number:'1.2-2' }} ฿
        </span>
      </li>
    </ul>
    <div *ngIf="getAllOrderItems().length === 0" class="bill-list-empty">
      <i class="ri-alert-line mr-1"></i> ไม่มีข้อมูลรายการอาหาร
    </div>
  </div>

  <!-- Payment & Slip -->
  <!-- {{ getTotalOrderAmount(reservation)}}
   {{ getTotalPaidAmount(reservation) | number:'1.2-2' }} ฿
   {{getPaymentStatus(reservation).status}} -->
  <div *ngIf="getPaymentStatus(reservation).status !== 'Paid'" class="bill-pay-section">
    <h4><i class="ri-money-dollar-circle-line"></i> ชำระเงิน</h4>
    <div>
      <div class="pay-info">
        <span class="pay-amount">{{ getTotalAmount() | number:'1.2-2' }} ฿</span>
        <span class="pay-status" [ngClass]="reservation.orders.length == 0 || getOverallPaymentStatus() === 'COMPLETED'
              ? 'pay-status-completed' : 'pay-status-waiting'">
          {{ reservation.orders.length == 0 || getOverallPaymentStatus() === 'COMPLETED'
            ? 'ชำระแล้ว' : 'รอชำระ' }}
        </span>
      </div>
      <div class="slip-img-wrap" *ngIf="getSlipUrl()">
        <img  [src]="getSlipUrl()" alt="Slip Image" class="slip-img" />
      </div>
      <div class="slip-upload-wrap" *ngIf="getOverallPaymentStatus() === 'PENDING' && reservation.orders.length > 0">
        <dropzone class="dropzone-container" [config]="config" [disabled]="disabled"
          [message]="'คลิกหรือวางไฟล์สลิปที่นี่เพื่ออัปโหลด'" (init)="onUploadInit($event)"
          (error)="onUploadError($event)" (success)="onUploadSuccess($event)">
        </dropzone>
        <button *ngIf="getOverallPaymentStatus() === 'PENDING' && reservation.orders.length > 0" type="button" class="ti-btn ti-btn-success ti-btn-xs mt-3 w-full" (click)="submitSlip()">
          <i class="ri-upload-cloud-2-line mr-1"></i> อัปโหลดสลิป
        </button>
      </div>
    </div>
  </div>

  <!-- ปุ่มเช็คบิล สำหรับยังไม่เช็คบิล -->
  <div *ngIf="(getOverallPaymentStatus() === 'PENDING' && reservation.status !== 'COMPLETED' && reservation.status === 'CHECKED_IN') || reservation.orders.length === 0" class="bill-checkout-btn-wrap">
    <button class="ti-btn ti-btn-success ti-btn-lg bill-checkout-btn" (click)="checkBill()"
      data-hs-overlay="#view-bill">
      <i class="ri-bill-line"></i> เช็คบิล/ชำระเงิน
    </button>
  </div>
</div>
