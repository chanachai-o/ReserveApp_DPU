<app-page-header [title]="'บริการหน้าร้าน'" [activeTitle]="'พนักงานเสิร์ฟ'"
  [title1]="'บริการหน้าร้าน'"></app-page-header>

<!-- ฟิลเตอร์แถบบน -->
<div class="box mb-6">
  <div class="box-body p-4 flex flex-wrap gap-4 items-center">
    <ng-select class="w-52 !rounded-md" [(ngModel)]="tableType" placeholder="ประเภท" (change)="onTypeChange()">
      <ng-option value="">ทั้งหมด</ng-option>
      <ng-option value="tables">โต๊ะ</ng-option>
      <ng-option value="room">ห้องประชุม</ng-option>
    </ng-select>
  </div>
</div>

<!-- Kanban Board -->
<div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-6">
  <!-- ว่าง -->
  <div class="kanban-tasks-type bg-gray-50 dark:bg-black/10 p-3 rounded-lg shadow-md">
    <div class="flex justify-between items-center mb-2">
      <span class="font-bold text-primary">ว่าง ({{ filteredAvailable.length }})</span>
    </div>
    <div class="space-y-4 max-h-[65vh] overflow-y-auto">
      <app-available-table-card *ngFor="let available of filteredAvailable" [item]="available"
        (openTable)="handleOpenTable($event)" (reserveTable)="handleReserveTable($event)">
      </app-available-table-card>
    </div>
  </div>
  <!-- มีการจอง -->
  <div class="kanban-tasks-type bg-yellow-50 dark:bg-yellow-900/10 p-3 rounded-lg shadow-md">
    <div class="flex justify-between items-center mb-2">
      <span class="font-bold text-warning">มีการจอง ({{ reservationList.length }})</span>
    </div>
    <div class="space-y-4 max-h-[65vh] overflow-y-auto">
      <app-reservation-card *ngFor="let res of reservationList" [reservation]="res" (checkIn)="handleCheckIn($event)"
        (cancel)="handleCancel($event)"></app-reservation-card>
    </div>
  </div>
  <!-- มีลูกค้า -->
  <div class="kanban-tasks-type bg-blue-50 dark:bg-blue-900/10 p-3 rounded-lg shadow-md">
    <div class="flex justify-between items-center mb-2">
      <span class="font-bold text-info">มีลูกค้า ({{ activeTableList.length }})</span>
    </div>
    <div class="space-y-4 max-h-[65vh] overflow-y-auto">
      <app-customer-card *ngFor="let item of activeTableList" [occupied]="item" (order)="onOrder($event)"
        (bill)="onBill($event)">
      </app-customer-card>
    </div>
  </div>
  <!-- ชำระเงิน -->
  <div class="kanban-tasks-type bg-green-50 dark:bg-green-900/10 p-3 rounded-lg shadow-md">
    <div class="flex justify-between items-center mb-2">
      <span class="font-bold text-success">ชำระเงิน ({{ paymentList.length }})</span>
    </div>
    <div class="space-y-4 max-h-[65vh] overflow-y-auto">
      <!-- <app-payment-card *ngFor="let pay of paymentList" [checkout]="pay" (viewBill)="onViewBill($event)"
        (verifyPayment)="onVerifyPayment($event)">
      </app-payment-card> -->
    </div>
  </div>
</div>


<!-- Start::add task modal -->
<div id="add-reserve" class="hs-overlay hidden ti-modal">
  <div class="hs-overlay-open:mt-7 ti-modal-box mt-0 ease-out">
    <div class="ti-modal-content">
      <div class="ti-modal-header">
        <h6 class="modal-title text-[1rem] font-semibold text-default dark:text-defaulttextcolor/70"
          id="mail-ComposeLabel">จอง</h6>
        <button type="button" class="hs-dropdown-toggle !text-[1rem] !font-semibold" data-hs-overlay="#add-reserve">
          <span class="sr-only">Close</span>
          <i class="ri-close-line"></i>
        </button>
      </div>
      <div class="ti-modal-body px-4 !overflow-visible">
        <app-table-reservation [tableId]="selectedTable?.id" [roomId]="selectedTable?.id"
          (reserve)="reserveTable($event)" [type]="selectedTable?.type"></app-table-reservation>
      </div>
    </div>
  </div>
</div>

<div id="add-check-in" class="hs-overlay hidden ti-modal">
  <div class="hs-overlay-open:mt-7 ti-modal-box mt-0 ease-out">
    <div class="ti-modal-content">
      <div class="ti-modal-header">
        <h6 class="modal-title text-[1rem] font-semibold text-default dark:text-defaulttextcolor/70"
          id="mail-ComposeLabel">Check-In</h6>
        <button type="button" class="hs-dropdown-toggle !text-[1rem] !font-semibold" data-hs-overlay="#add-check-in">
          <span class="sr-only">Close</span>
          <i class="ri-close-line"></i>
        </button>
      </div>
      <div class="ti-modal-body px-4 !overflow-visible">
        <app-table-reservation [tableId]="selectedTable?.id" [roomId]="selectedTable?.id"
          (reserve)="reserveTable($event)" [type]="selectedTable?.type" [status]="'checked_in'"></app-table-reservation>
      </div>
    </div>
  </div>
</div>
<!-- End::add task modal -->

<div id="add-order" class="hs-overlay hidden ti-modal">
  <div class="hs-overlay-open:mt-7 ti-modal-box mt-0 ease-out">
    <div class="ti-modal-content">
      <div class="ti-modal-header">
        <h6 class="modal-title text-[1rem] font-semibold text-default dark:text-defaulttextcolor/70"
          id="mail-ComposeLabel">สั่งอาหาร</h6>
        <button type="button" class="hs-dropdown-toggle !text-[1rem] !font-semibold" data-hs-overlay="#add-order">
          <span class="sr-only">Close</span>
          <i class="ri-close-line"></i>
        </button>
      </div>
      <div class="ti-modal-body px-4 !overflow-visible">
        <app-order-food [userId]="reservation?.user_id!" [reservationId]="reservation?.id!" [menuList]="menuList"
          (submitOrder)="handleOrder($event)">
        </app-order-food>
      </div>
    </div>
  </div>
</div>
<!-- End::add task modal -->

<div id="view-bill" class="hs-overlay hidden ti-modal">
  <div class="hs-overlay-open:mt-7 ti-modal-box mt-0 ease-out">
    <div class="ti-modal-content">
      <div class="ti-modal-header">
        <h6 class="modal-title text-[1rem] font-semibold text-default dark:text-defaulttextcolor/70"
          id="mail-ComposeLabel">ดูบิล</h6>
        <button type="button" class="hs-dropdown-toggle !text-[1rem] !font-semibold" data-hs-overlay="#add-order">
          <span class="sr-only">Close</span>
          <i class="ri-close-line"></i>
        </button>
      </div>
      <div class="ti-modal-body px-4 !overflow-visible">
        <!-- <app-view-bill [order]="selectedOrder"></app-view-bill> -->
      </div>
    </div>
  </div>
</div>
<!-- End::add task modal -->
