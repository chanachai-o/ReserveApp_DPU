<div
  class="box shadow-md rounded-2xl border border-yellow-200 dark:border-yellow-700 bg-white dark:bg-neutral-900 flex flex-col transition hover:scale-105">
  <div
    class="p-4 bg-gradient-to-r from-warning/50 to-white/80 dark:from-warning/15 rounded-t-2xl flex items-center justify-between">
    <div class="flex items-center gap-2 text-yellow-700">
      <i class="ri-login-circle-line text-2xl"></i>
      <span class="font-bold text-base">กำลังใช้</span>
    </div>
    <span class="badge bg-warning-100 text-warning-700 px-2 rounded">เลขที่ #{{ occupied.id}}</span>
  </div>
  <div class="flex flex-col items-center py-5 px-4 gap-2 flex-1">
    <img [src]="occupied.user.getPicture()" alt="user"
      class="rounded-full w-20 h-20 object-cover border" />
    <div class="mt-3 font-semibold text-gray-700 dark:text-white">{{ occupied.user.name ||
      occupied.user.phone || occupied.user_id || '-' }}</div>
    <div class="text-xs text-gray-400">เริ่มใช้ {{ occupied.start_time | date: 'HH:mm' }} ({{ occupied.num_people || '-'
      }} คน)</div>
  </div>
  <div class="flex justify-between px-4 pb-4">
    <button class="ti-btn ti-btn-primary ti-btn-xs rounded shadow" title="สั่งอาหาร" (click)="onOrder()"
      data-hs-overlay="#add-order">
      <i class="ri-restaurant-2-line mr-1"></i> สั่งอาหาร
    </button>
    <button class="ti-btn ti-btn-warning ti-btn-xs rounded shadow" title="เรียกบิล" (click)="onBill()"
      data-hs-overlay="#view-bill">
      <i class="ri-bill-line mr-1"></i> เรียกบิล
    </button>
  </div>
  <div class="border-t border-dashed bg-gray-50 dark:bg-neutral-800 rounded-b-2xl px-4 py-2 text-xs text-gray-500">
    <span>ถึง {{ occupied.end_time | date: 'HH:mm' }}</span>
    <span class="ml-3 text-blue-600">{{ occupied.note }}</span>
    <div class="flex flex-wrap gap-1">
      <ng-container *ngIf="occupied.orders?.length; else noOrder">
        <ng-container *ngFor="let order of occupied.orders.slice(-1)">
          <ng-container *ngFor="let item of order.order_items">
            <span class="badge bg-blue-100/60 text-blue-600 px-2 py-1 rounded shadow-sm">
              {{ item.menu.name }}
              <span *ngIf="item.quantity > 1" class="ml-1 text-xs text-gray-400">x{{ item.quantity }}</span>
            </span>
          </ng-container>
        </ng-container>
      </ng-container>
      <ng-template #noOrder>
        <span class="text-blue-600 italic">ยังไม่มีการสั่งอาหาร</span>
      </ng-template>
    </div>
  </div>
</div>
