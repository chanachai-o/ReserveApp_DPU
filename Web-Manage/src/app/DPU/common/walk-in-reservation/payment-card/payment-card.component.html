<!-- รอชำระเงิน -->
<div class="box kanban-tasks payment shadow-xl rounded-xl border-2 border-green-300 mb-5 bg-white dark:bg-neutral-900 transition-all duration-150 hover:scale-[1.01]" style="min-width: 290px;">
  <div class="box-body !p-0">
    <div class="p-4 flex flex-col gap-2 bg-gradient-to-r from-green/10 to-white/80 dark:from-green-900/20 dark:to-black/5 rounded-t-xl">
      <div class="flex justify-between items-center mb-2 text-base font-semibold">
        <div class="flex items-center gap-2">
          <span *ngIf="checkout.table" class="badge bg-success/10 text-success"><i class="ri-table-fill"></i> โต๊ะ {{ checkout.table.table_number }}</span>
          <span *ngIf="checkout.room" class="badge bg-amber-100 text-amber-600"><i class="ri-door-lock-fill"></i> ห้อง {{ checkout.room.name || checkout.room.room_number }}</span>
          <span class="text-gray-400" *ngIf="!checkout.table && !checkout.room">-</span>
        </div>
        <span class="text-xs text-gray-500 flex items-center gap-1">
          <i class="ri-user-3-line"></i>
          {{ checkout.user?.name || checkout.user?.phone || '-' }}
        </span>
      </div>
      <div class="flex flex-col md:flex-row md:items-end md:justify-between gap-2">
        <div class="flex items-center gap-2">
          <span class="font-bold text-green-700 text-lg">
            {{ getTotalAmount(checkout.orders) | number:'1.2-2' }} ฿
          </span>
          <span class="badge"
            [ngClass]="{
              'bg-green-100 text-green-700': checkout.status === 'completed',
              'bg-yellow-100 text-yellow-700': checkout.status !== 'completed'
            }">
            <i class="ri-exchange-dollar-line mr-1"></i>
            {{ checkout.status === 'completed' ? 'ชำระแล้ว' : 'รอชำระ' }}
          </span>
        </div>
        <div class="flex gap-2">
          <button class="ti-btn ti-btn-primary ti-btn-xs !rounded" (click)="onViewBill()" data-hs-overlay="#view-bill">
            <i class="ri-file-list-3-line mr-1"></i>ดูบิล
          </button>
          <button class="ti-btn ti-btn-success ti-btn-xs !rounded" (click)="onVerify()" *ngIf="checkout.status !== 'completed'">
            <i class="ri-check-double-line mr-1"></i>ยืนยันรับเงิน
          </button>
        </div>
      </div>
    </div>
    <div class="px-4 py-3 bg-gray-50 dark:bg-neutral-800 border-t border-dashed dark:border-defaultborder/10">
      <div class="font-semibold text-gray-600 dark:text-gray-200 text-xs mb-1 flex items-center gap-2">
        <i class="ri-restaurant-line"></i> รายการอาหาร
      </div>
      <div class="flex flex-wrap gap-1">
        <ng-container *ngFor="let order of checkout.orders">
          <ng-container *ngFor="let item of order.order_items">
            <span class="badge bg-blue-100/60 text-blue-600 px-2 py-1 rounded shadow-sm">
              {{ item.menu?.name }}
              <span *ngIf="item.quantity > 1" class="ml-1 text-xs text-gray-400">x{{ item.quantity }}</span>
            </span>
          </ng-container>
        </ng-container>
      </div>
      <div *ngIf="!checkout.orders?.length" class="text-gray-300 italic text-xs mt-2">ยังไม่มีข้อมูลอาหาร</div>
    </div>
    <div class="px-4 py-2 border-t border-dashed dark:border-defaultborder/10 rounded-b-xl flex items-center justify-between text-xs">
      <span>
        เวลาคิดเงิน: {{ checkout.end_time | date: 'short' }}
      </span>
      <span *ngIf="checkout.slip_url">
        <a [href]="checkout.slip_url" target="_blank" class="underline text-blue-500"><i class="ri-image-line"></i> ดูสลิป</a>
      </span>
    </div>
  </div>
</div>
