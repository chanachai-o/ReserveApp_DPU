<div class="max-w-7xl mx-auto p-4">
  <div
    class="bg-white dark:bg-neutral-900 rounded-2xl shadow-lg p-6 mb-6 border border-gray-100 dark:border-neutral-800">
    <div class="flex flex-col md:flex-row gap-4 mb-4 items-end">
      <!-- ลูกค้า -->
      <div class="flex-1 min-w-[180px]">
        <label class="block mb-1 font-semibold text-gray-700 dark:text-gray-200">ลูกค้า</label>
        <ng-select [items]="customerList" bindLabel="name" bindValue="id" [(ngModel)]="selectedCustomer"
          placeholder="ทั้งหมด" class="w-full !rounded-md" [clearable]="true">
        </ng-select>
      </div>
      <!-- ช่วงเวลา -->
      <div class="flex flex-row items-center flex-1 min-w-[270px] gap-2">
        <div>
          <label class="block mb-1 font-semibold text-gray-700 dark:text-gray-200">เริ่มวันที่</label>
          <input type="date" [(ngModel)]="dateFrom" class="form-control !rounded-md w-36" (keyup.enter)="filter()" />
        </div>
        <span class="mx-1 text-gray-400 mt-5 md:mt-6">-</span>
        <div>
          <label class="block mb-1 font-semibold text-gray-700 dark:text-gray-200">ถึงวันที่</label>
          <input type="date" [(ngModel)]="dateTo" class="form-control !rounded-md w-36" (keyup.enter)="filter()" />
        </div>
      </div>
      <!-- ปุ่ม Filter -->
      <div>
        <button type="button" class="ti-btn ti-btn-primary !rounded-lg px-5 flex gap-1 items-center h-10 mt-4 md:mt-0"
          (click)="filter()">
          <i class="ri-filter-3-line"></i> ค้นหา
        </button>
        <button type="button" class="ti-btn ti-btn-light !rounded-lg px-4 ml-2 h-10 mt-4 md:mt-0"
          (click)="dateFrom='';dateTo='';selectedCustomer=undefined;filter()">
          <i class="ri-refresh-line"></i> ล้าง
        </button>
      </div>
    </div>

    <!-- ตาราง -->
    <div class="table-responsive">
      <table class="table whitespace-nowrap min-w-full ti-custom-table-hover">
        <thead class="bg-gray-50 dark:bg-neutral-800">
          <tr class="border-b border-defaultborder">
            <th class="px-3 py-3 text-left font-semibold text-gray-700 dark:text-gray-200 text-sm">#</th>
            <th class="px-3 py-3 text-left font-semibold text-gray-700 dark:text-gray-200 text-sm">ลูกค้า</th>
            <th class="px-3 py-3 text-left font-semibold text-gray-700 dark:text-gray-200 text-sm">โต๊ะ/ห้อง</th>
            <th class="px-3 py-3 text-left font-semibold text-gray-700 dark:text-gray-200 text-sm">เวลาเริ่ม</th>
            <th class="px-3 py-3 text-left font-semibold text-gray-700 dark:text-gray-200 text-sm">จำนวน</th>
            <th class="px-3 py-3 text-left font-semibold text-gray-700 dark:text-gray-200 text-sm">สถานะ</th>
            <th class="px-3 py-3 text-right font-semibold text-gray-700 dark:text-gray-200 text-sm">ยอดเงิน</th>
            <!-- <th class="px-3 py-3 text-center font-semibold text-gray-700 dark:text-gray-200 text-sm"></th> -->
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let res of filteredList; let i = index"
            class="hover:bg-blue-50 dark:hover:bg-neutral-800/70 transition">
            <td class="px-3 py-2 text-gray-500">{{ i+1 }}</td>
            <td class="px-3 py-2 flex items-center gap-2">
              <img [src]="res.user.getPicture() || './assets/images/faces/111.jpg'"
                class="w-8 h-8 rounded-full border" />
              <span>{{ res.user.name || res.user.phone }}</span>
            </td>
            <td class="px-3 py-2">
              <span *ngIf="res.table">โต๊ะ {{ res.table.table_number }}</span>
              <span *ngIf="res.room">ห้อง {{ res.room.room_name }}</span>
            </td>
            <td class="px-3 py-2 text-gray-700 dark:text-gray-200">
              <i class="ri-time-line"></i> {{ res.start_time | date:'short' }}
            </td>
            <td class="px-3 py-2 text-center">{{ res.num_people }}</td>
            <td class="px-3 py-2">
              <span class="badge px-3 py-1" [ngClass]="{
              'bg-primary/10 text-primary': res.status === 'pending',
              'bg-warning text-green-700': (res.status === 'checked_in' || res.status === 'checked_out'),
              'bg-success text-gray-400': res.status === 'completed',
              'bg-danger text-rose-500': res.status === 'cancelled'
            }">
                {{ getStatusLabel(res.status) }}
              </span>
            </td>
            <td class="px-3 py-2 text-right font-semibold text-green-600">
              {{ getTotalAmount(res) | number:'1.2-2' }} ฿
            </td>
            <!-- <td class="px-3 py-2 text-center">
              <button class="ti-btn ti-btn-light ti-btn-xs !rounded" (click)="viewDetail(res)">
                <i class="ri-eye-line"></i>
              </button>
            </td> -->
          </tr>
          <tr *ngIf="filteredList.length===0">
            <td colspan="8" class="py-6 text-center text-gray-400">ไม่พบข้อมูล</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- Modal สำหรับดูรายละเอียดการจอง -->
  <!-- <app-reservation-detail-modal [reservation]="selectedReservation" [show]="showDetailModal" (closed)="showDetailModal=false"></app-reservation-detail-modal> -->
</div>
