<div class="booking-container">
  <!-- Filter/Search Bar -->
  <div class="booking-toolbar">
    <div class="booking-toolbar__filters">
      <input type="text" class="input" placeholder="ค้นหาโต๊ะ/ห้อง เช่น โต๊ะ 1, VIP" [(ngModel)]="searchText"
        (ngModelChange)="filterAvailable()" />
      <select class="input" [(ngModel)]="filterType" (change)="filterAvailable()">
        <option value="">ทั้งหมด</option>
        <option value="table">เฉพาะโต๊ะ</option>
        <option value="room">เฉพาะห้อง</option>
      </select>
      <select class="input" [(ngModel)]="filterCapacity" (change)="filterAvailable()">
        <option value="">ทุกขนาด</option>
        <option *ngFor="let n of [2, 4, 8, 10, 20, 50]" [value]="n">{{n}} คนขึ้นไป</option>
      </select>
    </div>
    <div>
      <button class="btn btn-light" (click)="showMap = !showMap">
        <i class="ri-map-pin-line"></i> ดูแผนผังร้าน
      </button>
    </div>
  </div>

  <!-- Floor Plan -->
  <div *ngIf="showMap" class="booking-map-overlay">
    <button class="booking-map-close" (click)="showMap = false">
      <i class="ri-close-line text-2xl"></i>
    </button>
    <img *ngIf="storeModel.getLayout()!=''" class="booking-map-img" [src]="storeModel.getLayout()" alt="แผนผังร้าน">
  </div>
  <div class="booking-main">
    <!-- Table/Room Selection -->
    <div class="booking-select">
      <h2 class="booking-title"><i class="ri-booking-line"></i> เลือกโต๊ะ/ห้องที่ต้องการจอง</h2>
      <div class="booking-grid">
        <app-available-item-card *ngFor="let item of filteredAvailableList" [item]="item"
          (reserve)="onReserve(item)"></app-available-item-card>
        <div *ngIf="filteredAvailableList.length === 0" class="booking-empty">
          ไม่มีโต๊ะหรือห้องตามเงื่อนไขที่เลือก
        </div>
      </div>
    </div>
    <!-- Booking List -->
    <div class="booking-sidebar">
      <h3 class="booking-subtitle"><i class="ri-calendar-check-line"></i> การจองของคุณ</h3>
      <ng-container *ngIf="reservationList.length; else noReservation">
        <app-cus-reservation-card *ngFor="let res of reservationList" [reservation]="res" (cancel)="onCancel(res)"
          (order)="onOrder(res)" (viewBill)="onViewBill(res)">
        </app-cus-reservation-card>
      </ng-container>
      <ng-template #noReservation>
        <div class="booking-no-reservation">
          <i class="ri-calendar-event-line"></i>
          <span>คุณยังไม่มีการจอง</span>
        </div>
      </ng-template>
    </div>
  </div>

  <!-- Modals (เหมือนเดิม) -->
  <app-table-reservation-modal [show]="showReserveModal" [item]="selectedItem" (reserved)="handleReserved($event)"
    (closed)="showReserveModal = false"></app-table-reservation-modal>
  <app-order-food-modal [show]="showOrderModal" [reservation]="selectedOrderRes" (submitted)="handleOrder($event)"
    (closed)="showOrderModal = false"></app-order-food-modal>
  <app-view-bill-modal [show]="showBillModal" [reservation]="selectedBillRes" (uploadSlip)="handleUploadSlip($event)"
    (checkOut)="handleCheckOut($event)" (closed)="showBillModal = false"></app-view-bill-modal>
</div>
